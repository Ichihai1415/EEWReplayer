using System.Reflection;
using static EEWReplayer.Utils.Common;

namespace EEWReplayer.Utils
{
    public static class DataConverter
    {
        public static double LatLon60to10(string latLon)
        {//137°18.1′	
            var dmSt = latLon.Replace("′", "").Split("°");
            return double.Parse(dmSt[0]) + double.Parse(dmSt[1]) / 60;
        }


        public static int[] AreasSt2Ints(string[] areas)
        {
            return areas.Select(area =>
            {
                if (ConvertSource.AreaForecastE_N2C.TryGetValue(area, out var code))
                    return code;
                else
                    return -1;
            }).Where(value => value != -1).ToArray();
        }
        public static int[] AreasSt2Ints(string areasSt, char separator, StringSplitOptions splitOptions = StringSplitOptions.None)
        {
            var areas = areasSt.Split(separator, splitOptions);
            return AreasSt2Ints(areas);
        }

        public static int[] AreasSt2Ints(string areasSt, string separator, StringSplitOptions splitOptions = StringSplitOptions.None)
        {
            var areas = areasSt.Split(separator, splitOptions);
            return AreasSt2Ints(areas);
        }
        public static string[] AreasInt2Sts(int[] code)
        {
            return code.Select(c =>
            {
                if (ConvertSource.AreaForecastE_C2N.TryGetValue(c, out var area))
                    return area;
                else
                    return "";
            }).Where(value => value != "").ToArray();
        }
        public static string AreasInt2Sts(int[] code, char separator) => string.Join(separator, AreasInt2Sts(code));

        public static string AreasInt2Sts(int[] code, string separator) => string.Join(separator, AreasInt2Sts(code));


        public static T? DeepCopy<T>(T obj)
        {
            if (obj == null)
                return default;

            var copy = (T?)Activator.CreateInstance(obj.GetType());
            foreach (FieldInfo field in obj.GetType().GetFields(BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.Public))
            {
                var fieldValue = field.GetValue(obj);
                if (fieldValue != null)
                    field.SetValue(copy, DeepCopy(fieldValue));
            }
            return copy;
        }


        public static class ConvertSource
        {

            public static readonly Dictionary<string, Intensity> Shindo_StringEnum = new()//"震度"等余計な文字なし　0にしたい場合明示的に"０"に
            {
                { "０", Intensity.S0 },
                { "１", Intensity.S1 },
                { "２", Intensity.S2 },
                { "３", Intensity.S3 },
                { "４", Intensity.S4 },
                { "５弱", Intensity.S5l },
                { "５強", Intensity.S5u },
                { "６弱", Intensity.S6l },
                { "６強", Intensity.S6u },
                { "７", Intensity.S7 },
                { "不明", Intensity.Unknown },
                { "—", Intensity.Unknown },
                { "---", Intensity.Unknown },
                { "level", Intensity.Level },
                { "予測なし", Intensity.None },
                { "", Intensity.None },
                { "長周期地震動階級１", Intensity.L1 },
                { "長周期地震動階級２", Intensity.L2 },
                { "長周期地震動階級３", Intensity.L3 },
                { "長周期地震動階級４", Intensity.L4 },
            };

            public static readonly Dictionary<Intensity, string> Shindo_EnumString = new()
            {
                { Intensity.S0, "０" },
                { Intensity.S1, "１" },
                { Intensity.S2, "２" },
                { Intensity.S3, "３" },
                { Intensity.S4, "４" },
                { Intensity.S5l, "５弱" },
                { Intensity.S5u, "５強" },
                { Intensity.S6l, "６弱" },
                { Intensity.S6u, "６強" },
                { Intensity.S7, "７" },
                { Intensity.None, "" },
                { Intensity.Unknown, "不明" },
                { Intensity.Level, "最大震度５弱程度以上と推定" },
                { Intensity.L1, "長周期地震動階級１" },
                { Intensity.L2, "長周期地震動階級２" },
                { Intensity.L3, "長周期地震動階級３" },
                { Intensity.L4, "長周期地震動階級４" },
            };

            #region AreaForecastE_C2N
            public static readonly Dictionary<int, string> AreaForecastE_C2N = new()
            {
                { 100, "石狩地方北部" },
                { 101, "石狩地方中部" },
                { 102, "石狩地方南部" },
                { 105, "渡島地方北部" },
                { 106, "渡島地方東部" },
                { 107, "渡島地方西部" },
                { 110, "檜山地方" },
                { 115, "後志地方北部" },
                { 116, "後志地方東部" },
                { 117, "後志地方西部" },
                { 119, "北海道奥尻島" },
                { 120, "空知地方北部" },
                { 121, "空知地方中部" },
                { 122, "空知地方南部" },
                { 125, "上川地方北部" },
                { 126, "上川地方中部" },
                { 127, "上川地方南部" },
                { 130, "留萌地方中北部" },
                { 131, "留萌地方南部" },
                { 135, "宗谷地方北部" },
                { 136, "宗谷地方南部" },
                { 139, "北海道利尻礼文" },
                { 140, "網走地方" },
                { 141, "北見地方" },
                { 142, "紋別地方" },
                { 145, "胆振地方西部" },
                { 146, "胆振地方中東部" },
                { 150, "日高地方西部" },
                { 151, "日高地方中部" },
                { 152, "日高地方東部" },
                { 155, "十勝地方北部" },
                { 156, "十勝地方中部" },
                { 157, "十勝地方南部" },
                { 160, "釧路地方北部" },
                { 161, "釧路地方中南部" },
                { 165, "根室地方北部" },
                { 166, "根室地方中部" },
                { 167, "根室地方南部" },
                { 200, "青森県津軽北部" },
                { 201, "青森県津軽南部" },
                { 202, "青森県三八上北" },
                { 203, "青森県下北" },
                { 210, "岩手県沿岸北部" },
                { 211, "岩手県沿岸南部" },
                { 212, "岩手県内陸北部" },
                { 213, "岩手県内陸南部" },
                { 220, "宮城県北部" },
                { 221, "宮城県南部" },
                { 222, "宮城県中部" },
                { 230, "秋田県沿岸北部" },
                { 231, "秋田県沿岸南部" },
                { 232, "秋田県内陸北部" },
                { 233, "秋田県内陸南部" },
                { 240, "山形県庄内" },
                { 241, "山形県最上" },
                { 242, "山形県村山" },
                { 243, "山形県置賜" },
                { 250, "福島県中通り" },
                { 251, "福島県浜通り" },
                { 252, "福島県会津" },
                { 300, "茨城県北部" },
                { 301, "茨城県南部" },
                { 310, "栃木県北部" },
                { 311, "栃木県南部" },
                { 320, "群馬県北部" },
                { 321, "群馬県南部" },
                { 330, "埼玉県北部" },
                { 331, "埼玉県南部" },
                { 332, "埼玉県秩父" },
                { 340, "千葉県北東部" },
                { 341, "千葉県北西部" },
                { 342, "千葉県南部" },
                { 350, "東京都２３区" },
                { 351, "東京都多摩東部" },
                { 352, "東京都多摩西部" },
                { 354, "神津島" },
                { 355, "伊豆大島" },
                { 356, "新島" },
                { 357, "三宅島" },
                { 358, "八丈島" },
                { 359, "小笠原" },
                { 360, "神奈川県東部" },
                { 361, "神奈川県西部" },
                { 370, "新潟県上越" },
                { 371, "新潟県中越" },
                { 372, "新潟県下越" },
                { 375, "新潟県佐渡" },
                { 380, "富山県東部" },
                { 381, "富山県西部" },
                { 390, "石川県能登" },
                { 391, "石川県加賀" },
                { 400, "福井県嶺北" },
                { 401, "福井県嶺南" },
                { 411, "山梨県中・西部" },
                { 412, "山梨県東部・富士五湖" },
                { 420, "長野県北部" },
                { 421, "長野県中部" },
                { 422, "長野県南部" },
                { 430, "岐阜県飛騨" },
                { 431, "岐阜県美濃東部" },
                { 432, "岐阜県美濃中西部" },
                { 440, "静岡県伊豆" },
                { 441, "静岡県東部" },
                { 442, "静岡県中部" },
                { 443, "静岡県西部" },
                { 450, "愛知県東部" },
                { 451, "愛知県西部" },
                { 460, "三重県北部" },
                { 461, "三重県中部" },
                { 462, "三重県南部" },
                { 500, "滋賀県北部" },
                { 501, "滋賀県南部" },
                { 510, "京都府北部" },
                { 511, "京都府南部" },
                { 520, "大阪府北部" },
                { 521, "大阪府南部" },
                { 530, "兵庫県北部" },
                { 531, "兵庫県南東部" },
                { 532, "兵庫県南西部" },
                { 535, "兵庫県淡路島" },
                { 540, "奈良県" },
                { 550, "和歌山県北部" },
                { 551, "和歌山県南部" },
                { 560, "鳥取県東部" },
                { 562, "鳥取県中部" },
                { 563, "鳥取県西部" },
                { 570, "島根県東部" },
                { 571, "島根県西部" },
                { 575, "島根県隠岐" },
                { 580, "岡山県北部" },
                { 581, "岡山県南部" },
                { 590, "広島県北部" },
                { 591, "広島県南東部" },
                { 592, "広島県南西部" },
                { 600, "徳島県北部" },
                { 601, "徳島県南部" },
                { 610, "香川県東部" },
                { 611, "香川県西部" },
                { 620, "愛媛県東予" },
                { 621, "愛媛県中予" },
                { 622, "愛媛県南予" },
                { 630, "高知県東部" },
                { 631, "高知県中部" },
                { 632, "高知県西部" },
                { 700, "山口県北部" },
                { 702, "山口県西部" },
                { 703, "山口県東部" },
                { 704, "山口県中部" },
                { 710, "福岡県福岡" },
                { 711, "福岡県北九州" },
                { 712, "福岡県筑豊" },
                { 713, "福岡県筑後" },
                { 720, "佐賀県北部" },
                { 721, "佐賀県南部" },
                { 730, "長崎県北部" },
                { 731, "長崎県南西部" },
                { 732, "長崎県島原半島" },
                { 735, "長崎県対馬" },
                { 736, "長崎県壱岐" },
                { 737, "長崎県五島" },
                { 740, "熊本県阿蘇" },
                { 741, "熊本県熊本" },
                { 742, "熊本県球磨" },
                { 743, "熊本県天草・芦北" },
                { 750, "大分県北部" },
                { 751, "大分県中部" },
                { 752, "大分県南部" },
                { 753, "大分県西部" },
                { 760, "宮崎県北部平野部" },
                { 761, "宮崎県北部山沿い" },
                { 762, "宮崎県南部平野部" },
                { 763, "宮崎県南部山沿い" },
                { 770, "鹿児島県薩摩" },
                { 771, "鹿児島県大隅" },
                { 774, "鹿児島県十島村" },
                { 775, "鹿児島県甑島" },
                { 776, "鹿児島県種子島" },
                { 777, "鹿児島県屋久島" },
                { 778, "鹿児島県奄美北部" },
                { 779, "鹿児島県奄美南部" },
                { 800, "沖縄県本島北部" },
                { 801, "沖縄県本島中南部" },
                { 802, "沖縄県久米島" },
                { 803, "沖縄県大東島" },
                { 804, "沖縄県宮古島" },
                { 805, "沖縄県石垣島" },
                { 806, "沖縄県与那国島" },
                { 807, "沖縄県西表島" }
            };
            #endregion

            #region AreaForecastE_N2C
            public static readonly Dictionary<string, int> AreaForecastE_N2C = new()
            {
                { "石狩地方北部", 100 },
                { "石狩地方中部", 101 },
                { "石狩地方南部", 102 },
                { "渡島地方北部", 105 },
                { "渡島地方東部", 106 },
                { "渡島地方西部", 107 },
                { "檜山地方", 110 },
                { "後志地方北部", 115 },
                { "後志地方東部", 116 },
                { "後志地方西部", 117 },
                { "北海道奥尻島", 119 },
                { "空知地方北部", 120 },
                { "空知地方中部", 121 },
                { "空知地方南部", 122 },
                { "上川地方北部", 125 },
                { "上川地方中部", 126 },
                { "上川地方南部", 127 },
                { "留萌地方中北部", 130 },
                { "留萌地方南部", 131 },
                { "宗谷地方北部", 135 },
                { "宗谷地方南部", 136 },
                { "北海道利尻礼文", 139 },
                { "網走地方", 140 },
                { "北見地方", 141 },
                { "紋別地方", 142 },
                { "胆振地方西部", 145 },
                { "胆振地方中東部", 146 },
                { "日高地方西部", 150 },
                { "日高地方中部", 151 },
                { "日高地方東部", 152 },
                { "十勝地方北部", 155 },
                { "十勝地方中部", 156 },
                { "十勝地方南部", 157 },
                { "釧路地方北部", 160 },
                { "釧路地方中南部", 161 },
                { "根室地方北部", 165 },
                { "根室地方中部", 166 },
                { "根室地方南部", 167 },
                { "青森県津軽北部", 200 },
                { "青森県津軽南部", 201 },
                { "青森県三八上北", 202 },
                { "青森県下北", 203 },
                { "岩手県沿岸北部", 210 },
                { "岩手県沿岸南部", 211 },
                { "岩手県内陸北部", 212 },
                { "岩手県内陸南部", 213 },
                { "宮城県北部", 220 },
                { "宮城県南部", 221 },
                { "宮城県中部", 222 },
                { "秋田県沿岸北部", 230 },
                { "秋田県沿岸南部", 231 },
                { "秋田県内陸北部", 232 },
                { "秋田県内陸南部", 233 },
                { "山形県庄内", 240 },
                { "山形県最上", 241 },
                { "山形県村山", 242 },
                { "山形県置賜", 243 },
                { "福島県中通り", 250 },
                { "福島県浜通り", 251 },
                { "福島県会津", 252 },
                { "茨城県北部", 300 },
                { "茨城県南部", 301 },
                { "栃木県北部", 310 },
                { "栃木県南部", 311 },
                { "群馬県北部", 320 },
                { "群馬県南部", 321 },
                { "埼玉県北部", 330 },
                { "埼玉県南部", 331 },
                { "埼玉県秩父", 332 },
                { "千葉県北東部", 340 },
                { "千葉県北西部", 341 },
                { "千葉県南部", 342 },
                { "東京都２３区", 350 },
                { "東京都多摩東部", 351 },
                { "東京都多摩西部", 352 },
                { "神津島", 354 },
                { "伊豆大島", 355 },
                { "新島", 356 },
                { "三宅島", 357 },
                { "八丈島", 358 },
                { "小笠原", 359 },
                { "神奈川県東部", 360 },
                { "神奈川県西部", 361 },
                { "新潟県上越", 370 },
                { "新潟県中越", 371 },
                { "新潟県下越", 372 },
                { "新潟県佐渡", 375 },
                { "富山県東部", 380 },
                { "富山県西部", 381 },
                { "石川県能登", 390 },
                { "石川県加賀", 391 },
                { "福井県嶺北", 400 },
                { "福井県嶺南", 401 },
                { "山梨県中・西部", 411 },
                { "山梨県東部・富士五湖", 412 },
                { "長野県北部", 420 },
                { "長野県中部", 421 },
                { "長野県南部", 422 },
                { "岐阜県飛騨", 430 },
                { "岐阜県美濃東部", 431 },
                { "岐阜県美濃中西部", 432 },
                { "静岡県伊豆", 440 },
                { "静岡県東部", 441 },
                { "静岡県中部", 442 },
                { "静岡県西部", 443 },
                { "愛知県東部", 450 },
                { "愛知県西部", 451 },
                { "三重県北部", 460 },
                { "三重県中部", 461 },
                { "三重県南部", 462 },
                { "滋賀県北部", 500 },
                { "滋賀県南部", 501 },
                { "京都府北部", 510 },
                { "京都府南部", 511 },
                { "大阪府北部", 520 },
                { "大阪府南部", 521 },
                { "兵庫県北部", 530 },
                { "兵庫県南東部", 531 },
                { "兵庫県南西部", 532 },
                { "兵庫県淡路島", 535 },
                { "奈良県", 540 },
                { "和歌山県北部", 550 },
                { "和歌山県南部", 551 },
                { "鳥取県東部", 560 },
                { "鳥取県中部", 562 },
                { "鳥取県西部", 563 },
                { "島根県東部", 570 },
                { "島根県西部", 571 },
                { "島根県隠岐", 575 },
                { "岡山県北部", 580 },
                { "岡山県南部", 581 },
                { "広島県北部", 590 },
                { "広島県南東部", 591 },
                { "広島県南西部", 592 },
                { "徳島県北部", 600 },
                { "徳島県南部", 601 },
                { "香川県東部", 610 },
                { "香川県西部", 611 },
                { "愛媛県東予", 620 },
                { "愛媛県中予", 621 },
                { "愛媛県南予", 622 },
                { "高知県東部", 630 },
                { "高知県中部", 631 },
                { "高知県西部", 632 },
                { "山口県北部", 700 },
                { "山口県西部", 702 },
                { "山口県東部", 703 },
                { "山口県中部", 704 },
                { "福岡県福岡", 710 },
                { "福岡県北九州", 711 },
                { "福岡県筑豊", 712 },
                { "福岡県筑後", 713 },
                { "佐賀県北部", 720 },
                { "佐賀県南部", 721 },
                { "長崎県北部", 730 },
                { "長崎県南西部", 731 },
                { "長崎県島原半島", 732 },
                { "長崎県対馬", 735 },
                { "長崎県壱岐", 736 },
                { "長崎県五島", 737 },
                { "熊本県阿蘇", 740 },
                { "熊本県熊本", 741 },
                { "熊本県球磨", 742 },
                { "熊本県天草・芦北", 743 },
                { "大分県北部", 750 },
                { "大分県中部", 751 },
                { "大分県南部", 752 },
                { "大分県西部", 753 },
                { "宮崎県北部平野部", 760 },
                { "宮崎県北部山沿い", 761 },
                { "宮崎県南部平野部", 762 },
                { "宮崎県南部山沿い", 763 },
                { "鹿児島県薩摩", 770 },
                { "鹿児島県大隅", 771 },
                { "鹿児島県十島村", 774 },
                { "鹿児島県甑島", 775 },
                { "鹿児島県種子島", 776 },
                { "鹿児島県屋久島", 777 },
                { "鹿児島県奄美北部", 778 },
                { "鹿児島県奄美南部", 779 },
                { "沖縄県本島北部", 800 },
                { "沖縄県本島中南部", 801 },
                { "沖縄県久米島", 802 },
                { "沖縄県大東島", 803 },
                { "沖縄県宮古島", 804 },
                { "沖縄県石垣島", 805 },
                { "沖縄県与那国島", 806 },
                { "沖縄県西表島", 807 }
            };
            #endregion


        }

    }

}
